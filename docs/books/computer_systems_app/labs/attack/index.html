<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Attack Lab #   ðŸ‘‹ Note: This is the 64-bit successor to the 32-bit Buffer Lab. Students are given a pair of unique custom-generated x86-64 binary executables, called targets, that have buffer overflow bugs. One target is vulnerable to code injection attacks. The other is vulnerable to return-oriented programming attacks. Students are asked to modify the behavior of the targets by developing exploits based on either code injection or return-oriented programming.">
<meta name=theme-color content="#FFFFFF"><meta property="og:title" content>
<meta property="og:description" content>
<meta property="og:type" content="website">
<meta property="og:url" content="http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/attack/">
<title>Attack | uni' docs</title>
<link rel=manifest href=/uni/manifest.json>
<link rel=icon href=/uni/favicon.png type=image/x-icon>
<link rel=stylesheet href=/uni/book.min.958cea7827621d6fbcb3acf091344c3e44e3d2a9428f9c3c38bb9eb37bf8c45d.css integrity="sha256-lYzqeCdiHW+8s6zwkTRMPkTj0qlCj5w8OLues3v4xF0=" crossorigin=anonymous>
<script defer src=/uni/flexsearch.min.js></script>
<script defer src=/uni/en.search.min.19449d76db9239cfbb22024e1a513056d996a3b2c1682876063b2903239d7f02.js integrity="sha256-GUSddtuSOc+7IgJOGlEwVtmWo7LBaCh2BjspAyOdfwI=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/attack/index.xml title="uni' docs">
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a href=/uni/><span>uni' docs</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/algorithms/>Algorithms</a>
<ul>
</ul>
</li>
<li>
<span>Books</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/>Computer Systems App</a>
<ul>
<li>
<span>Labs</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/architecture/>Architecture</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/attack/ class=active>Attack</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/binary_bomb/>Binary Bomb</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/buffer/>Buffer</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/cache/>Cache</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/data/>Data</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/malloc/>Malloc</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/performance/>Performance</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/proxy/>Proxy</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/shell/>Shell</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/crafting_interpreters/>Crafting Interpreters</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/data_science_from_scratch/>Data Science From Scratch</a>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/data_science_from_scratch/2_a_crash_course_in_python/>2 a Crash Course in Python</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/fp_in_scala/>Fp in Scala</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/programming_rust/>Programming Rust</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/books/the_rust_programming_language/>The Rust Programming Language</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/concurrency/>Concurrency</a>
<ul>
</ul>
</li>
<li>
<span>Databases</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/databases/fromscratch_heapfile_and_hashindex/>Fromscratch Heapfile and Hashindex</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/databases/sql/>SQL</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<span>Machine Learning</span>
<ul>
<li>
<span>Applications</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/self_driving_toy_car/>Self Driving Toy Car</a>
<ul>
</ul>
</li>
<li>
<span>Spam</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/spam/a_plan_for_spam/>A Plan for Spam</a>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/spam/a_plan_for_spam/datasets/>Datasets</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<span>Operating Systems</span>
<ul>
<li>
<span>Linux</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/operating_systems/linux/strace_in_seventy_lines/>Strace in Seventy Lines</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<span>Optimization</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/optimization/basic_neuralnet_lib/>Basic Neuralnet Lib</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/performance/>Performance</a>
<ul>
<li>
<span>Jvm</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/performance/jvm/bytebuffer-allocatedirect/>Bytebuffer Allocatedirect</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/performance/napkin-math/>Napkin Math</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<span>Tools</span>
<ul>
<li>
<span>Build</span>
<ul>
<li>
<span>Bazel</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/tools/build/bazel/rules_julia/>Rules Julia</a>
<ul>
</ul>
</li>
<li>
<a href=http://thundergolfer.com/uni/docs/tools/build/bazel/rules_nim/>Rules Nim</a>
<ul>
</ul>
</li>
</ul>
</li>
<li>
<span>Docs</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/tools/build/docs/technical-documentation-system/>Technical Documentation System</a>
<ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/uni/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Attack</strong>
<label for=toc-control>
<img src=/uni/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#_attack_-lab><em>Attack</em> Lab</a></li>
<li><a href=#contents>Contents</a></li>
<li><a href=#lab-assignment-write-up>Lab Assignment Write-Up</a></li>
<li><a href=#original-readmemd>Original <code>README.md</code></a>
<ul>
<li><a href=#1-overview>1. Overview</a></li>
<li><a href=#2-files>2. Files</a></li>
<li><a href=#3-solutions>3. Solutions</a></li>
<li><a href=#4-offering-the-attack-lab>4. Offering the Attack Lab</a></li>
</ul>
</li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h2 id=_attack_-lab>
<em>Attack</em> Lab
<a class=anchor href=#_attack_-lab>#</a>
</h2>
<blockquote>
<p>ðŸ‘‹ <strong>Note:</strong> This is the 64-bit successor to the 32-bit Buffer Lab. Students are given a pair of unique custom-generated x86-64 binary executables, called targets, that have buffer overflow bugs. One target is vulnerable to code injection attacks. The other is vulnerable to return-oriented programming attacks. Students are asked to modify the behavior of the targets by developing exploits based on either code injection or return-oriented programming. This lab teaches the students about the stack discipline and teaches them about the danger of writing code that is vulnerable to buffer overflow attacks.</p>
</blockquote>
<h2 id=contents>
Contents
<a class=anchor href=#contents>#</a>
</h2>
<ul>
<li>Files downloaded from CS:APP website as <code>target1.tar</code>, and listed below in the original README contents</li>
</ul>
<h2 id=lab-assignment-write-up>
Lab Assignment Write-Up
<a class=anchor href=#lab-assignment-write-up>#</a>
</h2>
<p><a href=http://csapp.cs.cmu.edu/3e/attacklab.pdf>csapp.cs.cmu.edu/3e/attacklab.pdf</a>.</p>
<p>This write-up is very helpful for even those doing self-study. Read through it to learn how to approach this lab&rsquo;s problem(s).</p>
<h2 id=original-readmemd>
Original <code>README.md</code>
<a class=anchor href=#original-readmemd>#</a>
</h2>
<p>This section is copied from <a href=http://csapp.cs.cmu.edu/3e/README-attacklab>csapp.cs.cmu.edu/3e/README-attacklab</a>.
It was modified only to conform to standard Markdown formatting.</p>
<p>It is not particularly useful for people doing self-study, but is reproduced here anyway.</p>
<hr>
<pre tabindex=0><code>##################################################
# CS:APP Attack Lab
# Directions to Instructors
#
# Copyright (c) 2016, R. Bryant and D. O'Hallaron
#
##################################################
</code></pre><p>This directory contains the files that you will use to build and run
the CS:APP Attack Lab.</p>
<p>The purpose of the Attack Lab is to help students develop a detailed
understanding of the stack discipline on x86-64 processors. It
involves applying a total of five buffer overflow attacks on some
executable files. There are three code injection attacks and two
return-oriented programming attacks.</p>
<p>The lab must be done on an x86-64 Linux system. It requires a version
of gcc that supports the -Og optimization flag (e.g., gcc
4.8.1). We&rsquo;ve tested it at CMU on Ubuntu 12.4 systems.</p>
<h3 id=1-overview>
1. Overview
<a class=anchor href=#1-overview>#</a>
</h3>
<h4 id=11-targets>
1.1. Targets
<a class=anchor href=#11-targets>#</a>
</h4>
<p>Students are given binaries called ctarget and rtarget that have a
buffer overflow bug. They are asked to alter the behavior of their
targets via five increasingly difficult exploits. The three attacks on
ctarget use code injection. The two attacks on rtarget use
return-oriented programming.</p>
<h4 id=12-solving-targets>
1.2. Solving Targets
<a class=anchor href=#12-solving-targets>#</a>
</h4>
<p>Each exploit involves reading a sequence of bytes from standard input
into a buffer stored on the stack. Students encode each exploit string
as a sequence of hex digit pairs separated by whitespace, where each
hex digit pair represents a byte in the exploit string. The program
&ldquo;hex2raw&rdquo; converts these strings into a sequence of raw bytes, which
can then be fed to the target:</p>
<pre><code>unix&gt; cat exploit.txt | ./hex2raw | ./ctarget
</code></pre>
<p>Each student gets their own custom-generated copy of ctarget and
rtarget. Thus, students must develop the solutions on their own and
cannot use the solutions from other students.</p>
<p>The lab writeup has extensive details on each phase and solution
techniques. We suggest that you read the writeup carefully before
continuing with this README file.</p>
<h4 id=13-autograding-service>
1.3. Autograding Service
<a class=anchor href=#13-autograding-service>#</a>
</h4>
<p>As with the Bomb and Bufer Labs, we have created a stand-alone
user-level autograding service that handles all aspects of the Attack
Lab for you: Students download their targets from a server. As the
students work on their targets, each successful solution is streamed
back to the server. The current results for each target are displayed
on a Web &ldquo;scoreboard.&rdquo; There are no explicit handins and the lab is
self-grading.</p>
<p>The autograding service consists of four user-level programs that run
in the main ./attacklab directory:</p>
<ul>
<li>
<p>Request Server (attacklab-requestd.pl). Students download their
targets and display the scoreboard by pointing a browser at a simple
HTTP server called the &ldquo;request server.&rdquo; The request server builds the
target files, archives them in a tar file, and then uploads the resulting tar
file back to the browser, where it can be saved on disk and
untarred. The request server also creates a copy of the targets and their
solutions for the instructor in the targets/ directory.</p>
</li>
<li>
<p>Result Server (attacklab-resultd.pl). Each time a student correctly
solves a target phase, the target sends a short HTTP message, called an
&ldquo;autoresult string,&rdquo; to an HTTP &ldquo;result server,&rdquo; which simply appends
the autoresult string to a &ldquo;scoreboard log file&rdquo; called log.txt.</p>
</li>
<li>
<p>Report Daemon (attacklab-reportd.pl). The &ldquo;report daemon&rdquo;
periodically scans the scoreboard log file. The report daemon finds
the most recent autoresult string submitted by each student for each
phase, and validates these strings by applying them to a local copy of
the student&rsquo;s targets. It then updates the HTML scoreboard
(attacklab-scoreboard.html) that summarizes the current number of
solutions for each target, rank ordered by the total number of accrued
points.</p>
</li>
<li>
<p>Main daemon (attacklab.pl). The &ldquo;main daemon&rdquo; starts and nannies the
request server, result server, and report daemon, ensuring that
exactly one of these processes (and itself) is running at any point in
time. If one of these processes dies for some reason, the main daemon
detects this and automatically restarts it. The main daemon is the
only program you actually need to run.</p>
</li>
</ul>
<h3 id=2-files>
2. Files
<a class=anchor href=#2-files>#</a>
</h3>
<p>The ./attacklab directory contains the following files:</p>
<ul>
<li>Makefile - For starting/stopping the lab and cleaning files</li>
<li>attacklab.pl* - Main daemon that nannies the other servers & daemons</li>
<li>Attacklab.pm - Attacklab configuration file</li>
<li>attacklab-reportd.pl* - Report daemon that continuously updates scoreboard</li>
<li>attacklab-requestd.pl* - Request server that serves targets to students</li>
<li>attacklab-resultd.pl* - Result server that gets autoresult strings from targets</li>
<li>attacklab-scoreboard.html - Real-time Web scoreboard</li>
<li>attacklab-update.pl - Helper to attacklab-reportd.pl that updates scoreboard</li>
<li>targets/ - Contains unique targets generated for each student, with solutions</li>
<li>log-status.txt - Status log with msgs from various servers and daemons</li>
<li>log.txt - Scoreboard log of autoresults received from targets</li>
<li>scores.csv - Summarizes current scoreboard scores for each student</li>
<li>src/ - Attacklab source files</li>
<li>validate.pl - Called periodically by report daemon. Validates solutions
for each student, and updates scoreboard and scores files.</li>
<li>writeup/ - Sample Latex Attack Lab writeup</li>
</ul>
<h3 id=3-solutions>
3. Solutions
<a class=anchor href=#3-solutions>#</a>
</h3>
<p>TargetID: Each target in a given instance of the lab has a unique
non-negative integer called the &ldquo;targetID.&rdquo;</p>
<p>The five solutions for target n are avalable to you in the
targets/target<n> directory, in the following files:</p>
<ul>
<li>Phase 1: ctarget.l1,</li>
<li>Phase 2: ctarget.l2,</li>
<li>Phase 3: ctarget.l3,</li>
<li>Phase 4: rtarget.l2,</li>
<li>Phase 5: rtarget.l3,</li>
</ul>
<p>where &ldquo;l&rdquo; stands for level.</p>
<h3 id=4-offering-the-attack-lab>
4. Offering the Attack Lab
<a class=anchor href=#4-offering-the-attack-lab>#</a>
</h3>
<p>There are two basic flavors of the Attack Lab: In the &ldquo;online&rdquo;
version, the instructor uses the autograding service to handout custom
targets to each student on demand, and to automatically track their
progress on the realtime scoreboard. In the &ldquo;offline&rdquo; version, the
instructor builds, hands out, and grades the student targets manually,
without using the autograding service.</p>
<p>While both versions give the students a rich experience, we recommend
the online version. It is clearly the most compelling and fun for the
students, and the easiest for the instructor to grade. However, it
requires that you keep the autograding service running non-stop,
because handouts, grading, and reporting occur continuously for the
duration of the lab. We&rsquo;ve made it very easy to run the service, but
some instructors may be uncomfortable with this requirement and will
opt instead for the offline version.</p>
<p>Here are the directions for offering both versions of the lab.</p>
<h4 id=41-create-a-clean-attack-lab-directory>
4.1. Create a Clean Attack Lab Directory
<a class=anchor href=#41-create-a-clean-attack-lab-directory>#</a>
</h4>
<p>Identify the Linux machine ($SERVER_NAME) where you will create the
Attack Lab directory (./attacklab) and, if you are offering the online
version, will run the autograding service. You&rsquo;ll only need to have a user
account on this machine. You don&rsquo;t need root access.</p>
<p>The machine must be x86-64 and have a relatively recent version of gcc
that supports the -Og optimization flag (e.g., gcc 4.8.1).</p>
<p>Each offering of the Attack Lab must start with a clean new ./attacklab
directory on $SERVER_NAME. For example:</p>
<pre><code>linux&gt; tar xvf attacklab.tar
linux&gt; cd attacklab
linux&gt; make cleanallfiles
</code></pre>
<h4 id=42-configure-the-attack-lab>
4.2 Configure the Attack Lab
<a class=anchor href=#42-configure-the-attack-lab>#</a>
</h4>
<p>If you are offering the online version, you will need to edit the
following files:</p>
<ul>
<li>
<p><strong><code>./Attacklab.pm</code></strong> - This is the main configuration file. You will only need
to modify or inspect a few variables in Section 1 of this file. Each
variable is preceded by a descriptive comment.</p>
</li>
<li>
<p><strong><code>./src/build/config.c</code></strong> - This file gives the course number and lists the
domain names of the hosts that targets are allowed to run on. Make
sure you update this correctly, else you and your students won&rsquo;t be
able to run your targets. You should include $SERVER_NAME (the machine
running the attacklab servers) in this list, along with any machines
that your students are allowed to submit from.</p>
</li>
<li>
<p><strong><code>./src/build/driverhdrs.h</code></strong> - This file provides the SERVER_NAME where
the attacklab servers are running. It must be identical to the
<code>$SERVER_NAME</code> in <code>Attacklab.pm</code>.</p>
</li>
</ul>
<h4 id=43-update-the-lab-writeup>
4.3. Update the Lab Writeup
<a class=anchor href=#43-update-the-lab-writeup>#</a>
</h4>
<p>Modify the Latex lab writeup in ./writeup/attacklab.tex for your
environment. Then type the following in the ./writeup directory:</p>
<pre><code>unix&gt; make clean; make
</code></pre>
<h4 id=44-offering-the-online-attack-lab>
4.4. Offering the Online Attack Lab
<a class=anchor href=#44-offering-the-online-attack-lab>#</a>
</h4>
<h5 id=441-short-version>
4.4.1. Short Version
<a class=anchor href=#441-short-version>#</a>
</h5>
<p>From the <code>./attacklab</code> directory:</p>
<p>(1) Reset the Attack Lab from scratch once by typing
linux> make cleanallfiles</p>
<p>(2) Start the autograding service by typing
linux> make start</p>
<p>(3) Stop the autograding service by typing
linux> make stop</p>
<p>You can start and stop the autograding service as often as you like
without losing any information. When in doubt &ldquo;make stop; make start&rdquo;
will get everything in a stable state.</p>
<p>However, resetting the lab deletes all old targets, status logs, and the
scoreboard log. Do this only during debugging, or the very first time
you start the lab for your students.</p>
<p>Students request their custom targets by pointing their browsers at
<code>http://$SERVER_NAME:15513/</code></p>
<p>Students view the scoreboard by pointing their browsers at <br>
<code>http://$SERVER_NAME:15513/scoreboard</code></p>
<p>where <code>$SERVER_NAME</code> is defined in <code>Attacklab.pm</code>.</p>
<h5 id=442-long-version>
4.4.2. Long Version
<a class=anchor href=#442-long-version>#</a>
</h5>
<p>(1) Resetting the Attack Lab. &ldquo;make stop&rdquo; ensures that there are no
servers running. &ldquo;make cleanallfiles&rdquo; resets the lab from scratch,
deleting all data specific to a particular instance of the lab, such
as the status log, all targets created by the request server, and the
scoreboard log. Do this when you&rsquo;re ready for the lab to go &ldquo;live&rdquo; to
the students.</p>
<p>Resetting is also useful while you&rsquo;re preparing the lab. Before the
lab goes live, you&rsquo;ll want to request a few targets for yourself, run
them, solve a few phases (using the solutions provided to instructors
in the targets directory), and make sure that the results are
displayed properly on the scoreboard. If there is a problem (say
because you forgot to update the list of machines the targets are
allowed to run on in src/build/config.c) you stop the servers, fix the
configuration, reset the lab, and then request and run more test
targets.</p>
<p>CAUTION: If you reset the lab after it&rsquo;s live, you&rsquo;ll lose all your
records of the students' targets and their solutions. You won&rsquo;t be able
to validate the students' handins. And your students will have to get
new targets and start over.</p>
<p>(2) Starting the Attack Lab. &ldquo;make start&rdquo; runs attacklab.pl, the main
daemon that starts and nannies the other programs in the service,
checking their status every few seconds and restarting them if
necessary:</p>
<p>(3) Stopping the Attack Lab. &ldquo;make stop&rdquo; kills all of the running
servers. You can start and stop the autograding service as often as
you like without losing any information. When in doubt &ldquo;make stop;
make start&rdquo; will get everything in a stable state.</p>
<p>Request Server: The request server is a simple special-purpose HTTP
server that (1) builds and delivers custom targets to student browsers
on demand, and (2) displays the current state of the real-time
scoreboard.</p>
<p>A student requests a target from the request daemon in two
steps: First, the student points their favorite browser at</p>
<pre><code>http://$SERVER_NAME:15513/
</code></pre>
<p>For example, <a href=http://foo.cs.cmu.edu:15513/>http://foo.cs.cmu.edu:15513/</a>. The request server
responds by sending an HTML form back to the browser. Next, the
student fills in this form with their user name and email address, and
then submits the form. The request server parses the form, builds and
tars up a target with targetID=n, and delivers the tar file to the
browser. The student then saves the tar file to disk. When the student
untars this file, it creates a directory (./target<n>) with the
following files:</p>
<ul>
<li>
<p><code>README.txt</code>: A file describing the contents of the directory.</p>
</li>
<li>
<p><code>ctarget</code>: An executable program vulnerable to code-injection attacks.</p>
</li>
<li>
<p><code>rtarget</code>: An executable program vulnerable to return-oriented
programming attacks.</p>
</li>
<li>
<p><code>cookie.txt</code>: An 8-digit hex code that serves as a unique identifier in
the attacks submitted to the results server.</p>
</li>
<li>
<p><code>farm.c</code>: The source code of this target&rsquo;s ``gadget farm,'' which are
used in generating return-oriented programming attacks.</p>
</li>
<li>
<p><code>hex2raw</code>: A utility to generate attack strings.</p>
</li>
</ul>
<p>The request server also creates a directory (attacklab/targets/target<n>)
that contains these files, along with the solutions for each of the five phases.
See the targets/target<n>/README.txt for details.</p>
<p>Result Server: Each time a student successfully solves a phase, the
target sends an HTTP message (called an autoresult string) to the
result server, which then appends the message to the scoreboard
log. Each message contains a targetID, the phase number, and the
exploit string.</p>
<p>Report Daemon: The report daemon periodically scrapes the scoreboard
log, validates the most recent submission from each target, and
updates the Web scoreboard with the results rank-ordered by score and
submission time. It also creates a CSV file with the scores for each
student. The update frequency is a configuration variable in
Attacklab.pm.</p>
<p>Instructors and students view the scoreboard by pointing their
browsers at:</p>
<pre><code>http://$SERVER_NAME:15513/scoreboard 
</code></pre>
<h5 id=443-grading-the-online-attack-lab>
4.4.3. Grading the Online Attack Lab
<a class=anchor href=#443-grading-the-online-attack-lab>#</a>
</h5>
<p>The online Attack Lab is self-grading. At any point in time, the CSV
file <code>./attacklab/scores.csv</code> contains the most recent scores for each
student. This file is created by the report daemon each time it
generates a new scoreboard.</p>
<h5 id=444-additional-notes-on-the-online-attack-lab>
4.4.4. Additional Notes on the Online Attack Lab
<a class=anchor href=#444-additional-notes-on-the-online-attack-lab>#</a>
</h5>
<ul>
<li>
<p>Since the request server and report daemon both need to execute
targets, you must include <code>$SERVER_NAME</code> in the list of legal machines
in your <code>attacklab/src/build/config.c</code> file.</p>
</li>
<li>
<p>All of the servers and daemons are stateless, so you can stop (&ldquo;make
stop&rdquo;) and start (&ldquo;make start&rdquo;) the lab as many times as you like
without any ill effects. If you accidentally kill one of the
daemons, or you modify a daemon, or the daemon dies for some reason,
then use &ldquo;make stop&rdquo; to clean up, and then restart with &ldquo;make
start&rdquo;. If your Linux box crashes or reboots, simply restart the
daemons with &ldquo;make start&rdquo;.</p>
</li>
<li>
<p>Information and error messages from the servers are appended to the
&ldquo;status log&rdquo; in <code>attack/log-status.txt</code>. Servers run quietly, so they
can be started from initrc scripts at boot time.</p>
</li>
<li>
<p>See the README files in <code>src/build/</code> and <code>src/solve</code> for details about
how targets are constructed and solved. Not necessary, but included
for completeness.</p>
</li>
<li>
<p>Before going live with the students, we like to check everything out
by running some tests. We do this by typing</p>
<p>linux> make cleanallfiles<br>
linux> make start</p>
</li>
</ul>
<p>Then we request a target for ourselves by pointing a Web browser at</p>
<pre><code>http://$SERVER_NAME:15513
</code></pre>
<p>After saving our target to disk, we untar it, copy it to a host in the
approved list in src/build/config.c, and then solve it using the
solution files in targets/target<n>: ctarget.l1, ctarget.l2,
ctarget.l3, rtarget.l2, and rtarget.l3.</p>
<p>Then we check the scoreboard to see that it&rsquo;s being updated correctly:
recorded on the scoreboard, which we check at</p>
<pre><code>http://$SERVER_NAME:15513/scoreboard
</code></pre>
<p>Once we&rsquo;re satisfied that everything is OK, we stop the lab</p>
<pre><code>linux&gt; make stop
</code></pre>
<p>and then go live:</p>
<pre><code>linux&gt; make cleanallfiles
linux&gt; make start
</code></pre>
<p>Once we go live, we type &ldquo;make stop&rdquo; and &ldquo;make start&rdquo; as often as we
need to, but we are careful never to type &ldquo;make cleanallfiles&rdquo; again.</p>
<h4 id=45-offering-the-offline-attack-lab>
4.5. Offering the Offline Attack Lab
<a class=anchor href=#45-offering-the-offline-attack-lab>#</a>
</h4>
<p>In this version of the lab, you build your own custom targets manually and
then hand them out to the students. The students work on solving
their targets offline (i.e., independently of any autograding service)
and then handin their solution files to you, each of which you grade
manually by feeding the exploit strings to the copy of the student&rsquo;s
targets.</p>
<p>You generate targets manually using the the src/build/buildtarget.pl
script, which must be run from the src/build directory. For example,
to generate target 2 for user bovik:</p>
<pre><code>linux&gt; cd src/build
linux&gt; ./buildtarget.pl -u bovik -t 2
</code></pre>
<p>This will generate a file called targets/target2.tar, which you then
hand out to the student.</p>
<p>Students will need to run ctarget and rtarget using the -q option,
which tells the targets not to try to contact the (non-existent)
grading server.</p>
<p>The student will hand in up to five exploit strings: bovik-ctarget.l1,
bovik-ctarget.l2, bovik-ctarget.l3, bovik-rtarget.l2, and
bovik-rtarget.l3. You evaluate each exploit by feeding it to the
ctarget or rtarget programs in the targets/target2directory. For
example:</p>
<pre><code>linux&gt; cat bovik-ctarget.l3 | ./src/hex2raw | ./targets/target2/ctarget -q
linux&gt; cat bovik-rtarget.l2 | ./src/hex2raw | ./targets/target2/rtarget -q
</code></pre>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#_attack_-lab><em>Attack</em> Lab</a></li>
<li><a href=#contents>Contents</a></li>
<li><a href=#lab-assignment-write-up>Lab Assignment Write-Up</a></li>
<li><a href=#original-readmemd>Original <code>README.md</code></a>
<ul>
<li><a href=#1-overview>1. Overview</a></li>
<li><a href=#2-files>2. Files</a></li>
<li><a href=#3-solutions>3. Solutions</a></li>
<li><a href=#4-offering-the-attack-lab>4. Offering the Attack Lab</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>