<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Architecture Lab #   üëãÔ∏è Note: Updated to Y86-64 for CS:APP3e. Students are given a small default Y86-64 array copying function and a working pipelined Y86-64 processor design that runs the copy function in some nominal number of clock cycles per array element (CPE). The students attempt to minimize the CPE by modifying both the function and the processor design. This gives the students a deep appreciation for the interactions between hardware and software.">
<meta name=theme-color content="#FFFFFF"><meta property="og:title" content>
<meta property="og:description" content>
<meta property="og:type" content="website">
<meta property="og:url" content="http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/architecture/">
<title>Architecture | uni' docs</title><link rel=manifest href=/uni/manifest.json>
<link rel=icon href=/uni/favicon.png type=image/x-icon>
<link rel=stylesheet href=/uni/book.min.958cea7827621d6fbcb3acf091344c3e44e3d2a9428f9c3c38bb9eb37bf8c45d.css integrity="sha256-lYzqeCdiHW+8s6zwkTRMPkTj0qlCj5w8OLues3v4xF0=" crossorigin=anonymous>
<script defer src=/uni/flexsearch.min.js></script>
<script defer src=/uni/en.search.min.3e18b957aaad79efe7a2e6c700a657499e5fe1f735157406cf60d31d75cc23e5.js integrity="sha256-Phi5V6qtee/noubHAKZXSZ5f4fc1FXQGz2DTHXXMI+U=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/architecture/index.xml title="uni' docs">
</head><body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a href=/uni/><span>uni' docs</span>
</a>
</h2><div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul>
<li>
<a href=http://thundergolfer.com/uni/docs/algorithms/>Algorithms</a>
<ul>
</ul></li><li>
<span>Books</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/>Computer Systems App</a>
<ul>
<li>
<span>Labs</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/architecture/ class=active>Architecture</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/attack/>Attack</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/binary_bomb/>Binary Bomb</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/buffer/>Buffer</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/cache/>Cache</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/data/>Data</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/malloc/>Malloc</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/performance/>Performance</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/proxy/>Proxy</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/computer_systems_app/labs/shell/>Shell</a>
<ul>
</ul></li></ul></li></ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/crafting_interpreters/>Crafting Interpreters</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/data_science_from_scratch/>Data Science From Scratch</a>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/books/data_science_from_scratch/2_a_crash_course_in_python/>2 a Crash Course in Python</a>
<ul>
</ul></li></ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/fp_in_scala/>Fp in Scala</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/programming_rust/>Programming Rust</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/books/the_rust_programming_language/>The Rust Programming Language</a>
<ul>
</ul></li></ul></li><li>
<a href=http://thundergolfer.com/uni/docs/concurrency/>Concurrency</a>
<ul>
</ul></li><li>
<span>Data Structures</span>
<ul>
</ul></li><li>
<span>Databases</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/databases/fromscratch_heapfile_and_hashindex/>Fromscratch Heapfile and Hashindex</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/databases/sql/>SQL</a>
<ul>
</ul></li></ul></li><li>
<span>Machine Learning</span>
<ul>
<li>
<span>Applications</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/self_driving_toy_car/>Self Driving Toy Car</a>
<ul>
</ul></li><li>
<span>Spam</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/spam/a_plan_for_spam/>A Plan for Spam</a>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/spam/a_plan_for_spam/datasets/>Datasets</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/machine_learning/applications/spam/a_plan_for_spam/web/>Web</a>
<ul>
</ul></li></ul></li></ul></li></ul></li></ul></li><li>
<span>Operating Systems</span>
<ul>
<li>
<span>Linux</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/operating_systems/linux/strace_in_seventy_lines/>Strace in Seventy Lines</a>
<ul>
</ul></li></ul></li></ul></li><li>
<span>Optimization</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/optimization/basic_neuralnet_lib/>Basic Neuralnet Lib</a>
<ul>
</ul></li></ul></li><li>
<a href=http://thundergolfer.com/uni/docs/performance/>Performance</a>
<ul>
<li>
<span>Jvm</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/performance/jvm/bytebuffer-allocatedirect/>Bytebuffer Allocatedirect</a>
<ul>
</ul></li></ul></li><li>
<a href=http://thundergolfer.com/uni/docs/performance/napkin-math/>Napkin Math</a>
<ul>
</ul></li></ul></li><li>
<span>Tools</span>
<ul>
<li>
<span>Build</span>
<ul>
<li>
<span>Bazel</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/tools/build/bazel/rules_julia/>Rules Julia</a>
<ul>
</ul></li><li>
<a href=http://thundergolfer.com/uni/docs/tools/build/bazel/rules_nim/>Rules Nim</a>
<ul>
</ul></li></ul></li><li>
<span>Docs</span>
<ul>
<li>
<a href=http://thundergolfer.com/uni/docs/tools/build/docs/technical-documentation-system/>Technical Documentation System</a>
<ul>
</ul></li></ul></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div></aside><div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/uni/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Architecture</strong>
<label for=toc-control>
<img src=/uni/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div><aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#_architecture_-lab><em>Architecture</em> Lab</a></li><li><a href=#contents>Contents</a></li><li><a href=#lab-assignment-write-up>Lab Assignment Write-Up</a></li><li><a href=#original-readmemd>Original <code>README.md</code></a>
<ul>
<li><a href=#1-overview>1. Overview</a></li><li><a href=#2-files>2. Files</a></li><li><a href=#3-building-the-lab>3. Building the Lab</a></li><li><a href=#4-grading-the-lab>4. Grading the Lab</a></li><li><a href=#5-notes>5. Notes</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=_architecture_-lab>
<em>Architecture</em> Lab
<a class=anchor href=#_architecture_-lab>#</a>
</h2><blockquote>
<p>üëãÔ∏è <strong>Note:</strong> Updated to Y86-64 for CS:APP3e. Students are given a small default Y86-64 array copying function and a working pipelined Y86-64 processor design that runs the copy function in some nominal number of clock cycles per array element (CPE). The students attempt to minimize the CPE by modifying both the function and the processor design. This gives the students a deep appreciation for the interactions between hardware and software.</p></blockquote><blockquote>
<p><strong>Note:</strong> The lab materials include the master source distribution of the Y86-64 processor simulators and the Y86-64 Guide to Simulators. (<em>I unzipped it into <code>tar/</code></em>)</p></blockquote><h2 id=contents>
Contents
<a class=anchor href=#contents>#</a>
</h2><ul>
<li>Files downloaded from CS:APP website as <code>archlab-handout.tar</code>, and listed below in the original README contents</li></ul><h2 id=lab-assignment-write-up>
Lab Assignment Write-Up
<a class=anchor href=#lab-assignment-write-up>#</a>
</h2><p><a href=http://csapp.cs.cmu.edu/3e/archlab.pdf>csapp.cs.cmu.edu/3e/archlab.pdf</a>.</p><p>This write-up is pretty helpful for even those doing self-study. Read through it to learn how to approach this lab&rsquo;s problem.</p><h2 id=original-readmemd>
Original <code>README.md</code>
<a class=anchor href=#original-readmemd>#</a>
</h2><p>This section is copied from <a href=http://csapp.cs.cmu.edu/3e/README-archlab>csapp.cs.cmu.edu/3e/README-archlab</a>.
It was modified only to conform to standard Markdown formatting.</p><p>It is not particularly useful for people doing self-study, but is reproduced here anyway.</p><hr>
<pre tabindex=0><code>#####################################################################
# CS:APP Architecture Lab
# Directions to Instructors
#
# Copyright (c) 2002, 2011, 2015 R. Bryant and D. O&#39;Hallaron,
# All rights reserved. May not be used, modified, or copied without permission.
#
######################################################################
</code></pre><p>This directory contains the files that you will need to run the CS:APP
architecture lab, which develops a student&rsquo;s understanding of
processor design and the close relationship between software and
hardware.</p><h3 id=1-overview>
1. Overview
<a class=anchor href=#1-overview>#</a>
</h3><p>In this lab, students learn about the design and implementation of a
pipelined Y86-64 processor, optimizing its performance on a benchmark Y86-64
array copy program called ncopy.ys. Students are allowed to make any
semantics preserving transformations to the benchmark program, or to
make enhancements to the pipelined processor, or both. The goal is to
minimize the number of clock cycles per array element (CPE).</p><h3 id=2-files>
2. Files
<a class=anchor href=#2-files>#</a>
</h3><ul>
<li>Makefile Makefile that builds the Lab</li><li>README This file</li><li>archlab-handout/ The files handed out to the students</li><li>grade/ Autograding scripts</li><li>simguide/ CS:APP Guide to Simulators document</li><li>src/ Master distribution of the Y86-64 tools</li><li>sim/ Student distribution of the Y86-64 tools (subset of src)</li><li>writeup/ The architecture lab writeup</li></ul><h3 id=3-building-the-lab>
3. Building the Lab
<a class=anchor href=#3-building-the-lab>#</a>
</h3><p>Step 1: Build the &ldquo;master distribution&rdquo; of the Y86-64 tools in directory
<code>./src</code> on your system. The master distribution is the instructor&rsquo;s
version of the tools that contains the solution files for the lab.
See <code>./src/README</code> for instructions on how to build the master
distribution. The process involves setting three variables in
<code>./src/Makefile</code> and then typing &ldquo;make&rdquo;. The default values are for
Linux.</p><p>Step 2. Modify ./src/Makefile-sim with the same three variable
assignments that you used in ./src/Makefile. The Makefile-sim file is
the Makefile that the students will use their in their personal
student distributions of the Y86-64 tools. The student distribution is a
subset of the master distribution, minus the solution files and a
master set of HCL files.</p><p>Step 3. Modify ./src/Makefile-handout with the default team name
(TEAM), default handin version number (VERSION), and the directories
where the three parts should be copied to when they are handed in
(HANDINDIR-PART{A,B,C}). The Makefile-handout file is the
the Makefile that the students receive in the archlab-handout/.
They use it to hand in their solutions.</p><p>Step 4: Modify the Latex writeup in ./writeup/archlab.tex to reflect
the handout and handin directions for your site. If you don&rsquo;t use
Latex, use your favorite document preparation system to prepare
Postcript and PDF versions of the writeup in archlab.pdf.</p><p>Step 5: Modify ./Makefile with the name of the lab (LABNAME) and the
name of the directory where the handout tarfile will be copied to and
where the students can pick it from (DEST). LABNAME is typically
archlab.</p><p>Step 6: In the same directory as this README file, type</p><pre><code>make clean; make
</code></pre><p>to the shell. This will do the following things:</p><p>(a) Compile the master distribution of the Y86-64 tools in ./src
(b) Build the student distribution in ./sim
(c) Build a tarfile of the student distribution in sim.tar
(d) Build a handout directory ./$(LABNAME)-handout
(e) Build the $(LABNAME)-handout.tar file that you will be
handing out to students.</p><p>Step 7: Type &ldquo;make dist&rdquo; to copy the $(LABNAME)-handout.tar file
and the writeup to the distribution directory where the students
will retrieve the lab.</p><h3 id=4-grading-the-lab>
4. Grading the Lab
<a class=anchor href=#4-grading-the-lab>#</a>
</h3><p>There are Perl autograding scripts for each part of this lab.
See <code>./grade/README</code> for details.</p><h3 id=5-notes>
5. Notes
<a class=anchor href=#5-notes>#</a>
</h3><ul>
<li>
<p>If you are running in GUI mode, you&rsquo;ll need to install Tcl/Tk along
with the Tcl and Tk developer&rsquo;s packages. On an Ubuntu machine:</p><p><code>linux> sudo apt-get tcl tcl-dev tk tk-dev</code></p></li><li>
<p>If you are running in GUI mode on a system with X windows, make sure
that your DISPLAY environment variable is set:</p><p><code>linux> setenv DISPLAY mymachine.myschool.edu:0</code></p><p>If you&rsquo;re using ssh, you can set the DISPLAY variable automatically by
using the &ldquo;ssh -X hostname&rdquo; command.</p></li><li>
<p>The lab compiles with no warnings and passes all regression tests on
the following systems:</p><ul>
<li>Linux/2.2.20, Pentium III, gcc 2.95.3, Gnu make, Perl 5</li><li>Solaris/5.8, Sparc Ultra 80, gcc 2.95.3, Sun make, Perl 5</li><li>Linux/2.6.18, Intel x86_64, gcc 4.3.5, Perl 5.8.8</li></ul></li><li>
<p>The autograders for parts B and C run the regression tests in ptest/
as part of the evaluation of the student solutions. On older
systems, these tests can take a long time, 5 minutes or so, with
most of the time being spent by the htest.pl script. If this is too
long, you can sacrifice completeness for speed by commenting out the
call to htest.pl in ptest/Makefile.</p></li></ul></article><footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>
</footer><div class=book-comments>
</div><label for=menu-control class="hidden book-menu-overlay"></label>
</div><aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#_architecture_-lab><em>Architecture</em> Lab</a></li><li><a href=#contents>Contents</a></li><li><a href=#lab-assignment-write-up>Lab Assignment Write-Up</a></li><li><a href=#original-readmemd>Original <code>README.md</code></a>
<ul>
<li><a href=#1-overview>1. Overview</a></li><li><a href=#2-files>2. Files</a></li><li><a href=#3-building-the-lab>3. Building the Lab</a></li><li><a href=#4-grading-the-lab>4. Grading the Lab</a></li><li><a href=#5-notes>5. Notes</a></li></ul></li></ul></nav></div></aside></main></body></html>